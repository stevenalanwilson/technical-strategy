<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Strategy Ontology Diagram</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; }
    .node rect {
      rx: 8;
      ry: 8;
      stroke: #333;
      stroke-width: 2px;
      filter: drop-shadow(0px 1.5px 2px #99999944);
    }
    .node text {
      fill: #000;
      font-size: 14px;
      font-weight: bold;
      text-anchor: middle;
      alignment-baseline: middle;
      pointer-events: none;
    }
    .link {
      fill: none;
      stroke: #888;
      stroke-width: 2.5px;
      marker-end: url(#arrow);
      opacity: 0.8;
    }
    .band-label {
      font-weight: bold;
      font-size: 13px;
      fill: #555;
      text-anchor: middle;
    }
    svg { background: #fff; }
  </style>
</head>
<body>
<svg width="1250" height="540"></svg>
<script>
// Band info for columns
const bands = [
  { label: 'Enduring',        color: '#fff2b0', x: 60,   width: 190 },
  { label: '3 to 5 years',    color: '#cbe4ff', x: 260,  width: 180 },
  { label: '1 year',          color: '#d8f2c3', x: 460,  width: 180 },
  { label: 'Quarter',         color: '#ffd8b2', x: 660,  width: 190 },
  { label: 'Next',            color: '#ffeac3', x: 870,  width: 270 }
];

const nodes = [
  { id: "Purpose",          col: 0, y: 80 },
  { id: "Vision",           col: 0, y: 170 },
  { id: "Core Values",      col: 0, y: 260 },
  { id: "Targets",          col: 1, y: 170 },
  { id: "Annual Goals",     col: 2, y: 120 },
  { id: "KPIs",             col: 2, y: 220 },
  { id: "Key Initiatives",  col: 3, y: 120 },
  { id: "Meeting Rhythms",  col: 4, y: 120 }
];

// Logical connections
const links = [
  { source: "Purpose",         target: "Vision" },
  { source: "Vision",          target: "Core Values" },
  { source: "Core Values",     target: "Targets" },
  { source: "Targets",         target: "Annual Goals" },
  { source: "Annual Goals",    target: "KPIs" },
  { source: "KPIs",            target: "Key Initiatives" },
  { source: "Key Initiatives", target: "Meeting Rhythms" }
];

const svg = d3.select("svg");
const nodeWidth = 130, nodeHeight = 58;

// Render colored bands/columns
svg.selectAll(".band")
  .data(bands)
  .enter().append("rect")
    .attr("x", d => d.x)
    .attr("y", 0)
    .attr("width", d => d.width)
    .attr("height", 540)
    .attr("fill", d => d.color)
    .attr("stroke", "#888")
    .attr("stroke-width", 1)
    .attr("opacity", 0.55);

svg.selectAll(".band-label")
  .data(bands)
  .enter().append("text")
    .attr("class", "band-label")
    .attr("x", d => d.x + d.width/2)
    .attr("y", 36)
    .text(d => d.label);

// Place nodes
const nodeGroups = svg.selectAll(".node")
  .data(nodes)
  .enter().append("g")
    .attr("class", "node")
    .attr("transform", d => {
      const bandX = bands[d.col].x;
      const bandW = bands[d.col].width;
      return `translate(${bandX + bandW/2 - nodeWidth/2},${d.y})`;
    });

nodeGroups.append("rect")
  .attr("width", nodeWidth)
  .attr("height", nodeHeight)
  .attr("fill", d => bands[d.col].color)
  .attr("stroke", "#333");

nodeGroups.append("text")
  .attr("x", nodeWidth/2)
  .attr("y", nodeHeight/2 + 5)
  .text(d => d.id);

// Helper: get center coordinates for a node for links
function getNodeCenter(nodeId) {
  const node = nodes.find(n => n.id === nodeId);
  const x = bands[node.col].x + bands[node.col].width/2;
  const y = node.y + nodeHeight/2;
  return { x, y };
}

// Arrow marker
svg.append("defs").append("marker")
  .attr("id", "arrow")
  .attr("viewBox", "0 0 10 10")
  .attr("refX", 9.5)
  .attr("refY", 5)
  .attr("markerWidth", 7)
  .attr("markerHeight", 7)
  .attr("orient", "auto")
  .append("path")
  .attr("d", "M 0 0 L 10 5 L 0 10 z")
  .attr("fill", "#888");

// Draw links
svg.selectAll(".link")
  .data(links)
  .enter().append("path")
    .attr("class", "link")
    .attr("d", d => {
      const from = getNodeCenter(d.source);
      const to = getNodeCenter(d.target);
      // Use a cubic curve for a gentle transition between columns
      const dx = (to.x - from.x) * 0.45;
      return `M${from.x},${from.y} C${from.x+dx},${from.y} ${to.x-dx},${to.y} ${to.x},${to.y}`;
    });

</script>
</body>
</html>
