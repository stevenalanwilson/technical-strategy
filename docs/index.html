<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Strategy Ontology Diagram</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #fff;
  }
  .box {
    stroke: #333;
    stroke-width: 1.5px;
    rx: 6;
    ry: 6;
  }
  .label {
    font-size: 12px;
    text-anchor: middle;
    alignment-baseline: middle;
    fill: #000;
  }
  .link {
    fill: none;
    stroke: #555;
    stroke-width: 1.5px;
    marker-end: url(#arrow);
  }
  .column-label {
    font-weight: bold;
    font-size: 14px;
    text-anchor: middle;
    fill: #333;
  }
</style>
</head>
<body>
<svg width="1200" height="600"></svg>

<script>
const svg = d3.select("svg");
const width = +svg.attr("width");
const height = +svg.attr("height");

// Column definitions
const columns = [
  { name: "Enduring", color: "#fff2cc", entities: ["Purpose", "Vision", "Core Values"] },
  { name: "3-5 years", color: "#d0e0e3", entities: ["Targets"] },
  { name: "1 year", color: "#d9ead3", entities: ["Annual Goals", "KPIs"] },
  { name: "Quarter", color: "#fce5cd", entities: ["Key Initiatives"] },
  { name: "Next", color: "#f9cb9c", entities: ["Meeting Rhythms"] }
];

// Box size & spacing
const boxWidth = 140, boxHeight = 50;
const colSpacing = 200, rowSpacing = 90;
const startX = 100, startY = 100;

// Arrows marker
svg.append("defs").append("marker")
  .attr("id", "arrow")
  .attr("viewBox", "0 0 10 10")
  .attr("refX", 10)
  .attr("refY", 5)
  .attr("markerWidth", 6)
  .attr("markerHeight", 6)
  .attr("orient", "auto")
  .append("path")
    .attr("d", "M 0 0 L 10 5 L 0 10 z")
    .attr("fill", "#555");

// Build node positions
let nodes = [];
let links = [];
columns.forEach((col, ci) => {
  col.entities.forEach((ent, ei) => {
    const x = startX + ci * colSpacing;
    const y = startY + ei * rowSpacing + (col.entities.length === 1 ? rowSpacing/2 : 0);
    nodes.push({ id: ent, column: col.name, color: col.color, x, y });
  });
});
// Define logical connections
links = [
  {source: "Purpose", target: "Vision"},
  {source: "Vision", target: "Core Values"},
  {source: "Core Values", target: "Targets"},
  {source: "Targets", target: "Annual Goals"},
  {source: "Annual Goals", target: "KPIs"},
  {source: "KPIs", target: "Key Initiatives"},
  {source: "Key Initiatives", target: "Meeting Rhythms"}
];

// Draw columns background & labels
columns.forEach((col, ci) => {
  const x = startX + ci * colSpacing - boxWidth/2 - 20;
  svg.append("rect")
    .attr("x", x)
    .attr("y", 50)
    .attr("width", boxWidth + 40)
    .attr("height", height - 100)
    .attr("fill", col.color)
    .attr("opacity", 0.4);

  svg.append("text")
    .attr("class", "column-label")
    .attr("x", x + (boxWidth+40)/2)
    .attr("y", 40)
    .text(col.name);
});

// Draw links
svg.selectAll(".link")
  .data(links)
  .enter()
  .append("line")
  .attr("class", "link")
  .attr("x1", d => nodes.find(n => n.id === d.source).x)
  .attr("y1", d => nodes.find(n => n.id === d.source).y)
  .attr("x2", d => nodes.find(n => n.id === d.target).x)
  .attr("y2", d => nodes.find(n => n.id === d.target).y);

// Draw nodes
const gNodes = svg.selectAll(".node")
  .data(nodes)
  .enter()
  .append("g")
  .attr("class", "node")
  .attr("transform", d => `translate(${d.x},${d.y})`);

gNodes.append("rect")
  .attr("class", "box")
  .attr("x", -boxWidth/2)
  .attr("y", -boxHeight/2)
  .attr("width", boxWidth)
  .attr("height", boxHeight)
  .attr("fill", d => d.color);

gNodes.append
